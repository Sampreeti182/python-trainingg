SELECT 
    o.order_id,
    o.order_date,
    o.customer_id,
    o.total_amount,
    o.product_id,
    c.customer_name
FROM orders o
LEFT JOIN customers c ON o.customer_id = c.customer_id;

SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    o.product_id
FROM orders o
WHERE o.customer_id IS NULL;

SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    o.product_id,
    c.city AS customer_city
FROM orders o
LEFT JOIN customers c ON o.customer_id = c.customer_id;

SELECT 
    c.customer_name,
    COUNT(o.order_id) AS number_of_orders
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
GROUP BY c.customer_name;

SELECT 
    c.customer_name
FROM customers c
LEFT JOIN orders o ON c.customer_id = o.customer_id
WHERE o.order_id IS NULL;


SELECT 
    o.order_id,
    o.order_date,
    o.total_amount,
    o.product_id,
    c.customer_name,
    c.city
FROM orders o
LEFT JOIN customers c ON o.customer_id = c.customer_id
WHERE c.city = 'Delhi' OR c.customer_id IS NULL;


SELECT COUNT(o.order_id) AS total_orders
FROM orders o;

SELECT 
    (COUNT(CASE WHEN o.customer_id IS NULL THEN 1 END) / COUNT(o.order_id)) * 100 AS percentage_missing_customers
FROM orders o;
